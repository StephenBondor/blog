{"version":3,"sources":["webpack:///path---the-timezone-struggle-b2ffdb245913314e347e.js","webpack:///./.cache/json/the-timezone-struggle.json"],"names":["webpackJsonp","343","module","exports","data","site","siteMetadata","title","author","markdownRemark","id","html","excerpt","frontmatter","date","path","pathContext"],"mappings":"AAAAA,cAAc,iBAERC,IACA,SAAUC,EAAQC,GCHxBD,EAAAC,SAAkBC,MAAQC,MAAQC,cAAgBC,MAAA,YAAAC,OAAA,cAA0CC,gBAAmBC,GAAA,oIAAAC,KAAA,w4bAAw1cC,QAAA,+TAAAC,aAAgaN,MAAA,wBAAAO,KAAA,qBAAAC,KAAA,4BAA8FC","file":"path---the-timezone-struggle-b2ffdb245913314e347e.js","sourcesContent":["webpackJsonp([245742162621177],{\n\n/***/ 343:\n/***/ (function(module, exports) {\n\n\tmodule.exports = {\"data\":{\"site\":{\"siteMetadata\":{\"title\":\"Pav Sidhu\",\"author\":\"Pav Sidhu\"}},\"markdownRemark\":{\"id\":\"/Users/bondor/Desktop/Lambda/Projects/blog/src/pages/2016-12-27-the-timezone-struggle/index.md absPath of file >>> MarkdownRemark\",\"html\":\"<p>Something I recently found difficult to get my head around was how timezones work. It’s one of those things you tend to avoid as much as possible, however, I realised that there was quite a big flaw in my website, Revisify, that needed addressing.</p>\\n<p>For those of you who don’t know, Revisify is a tool I built to help students study. Students can create questions, test themselves and progress. I have one feature available, study streaks, which count the number consecutive days a student has been studying.</p>\\n<p>\\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 700px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 57.45614035087719%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAABT0lEQVQoz4WS3UoCQRTHfYuSUtzV8WOdmd352q/MVhQxk5LIJNKKgiJauqmg296it+gNuusNuu8Zgu63Yx/i2pLwhzmHOb8558+ZFGJOwbJnpRORN1WeStAk/gpAc2VF7qbgmF6DkKn4erMsXEOtlYUHcdWuVaQP0omMVTInBkOfInN6w9He+PT4Itzo7vT2Rwdnl6PzsDcc56qs8DtRAjyZjcoctZdNb5X5iNmQIssucRfFyxJgKM0QJSz2UCuFnqERocNbVQaaNZ8AA6lRhSl7HZDothldeY9NY8kQKmizekvD/D8YUZnG6tAh0VHl4343uum89XWEmd3aqm32F8DfMweCvQ8L0V07uvaeuyhLlek3qBfMkQmeofkKlie+9TIQT9uWz3kGC15vyUZngedp/zSWaYOD2yxRkOpU/G37AyfswJSwT/gtKImZhT8BL+OH+bldzJgAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\\\"\\n        alt=\\\"Here’s what the study streak looks like.\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/study-streak-e3cf398f9c16ca848a7552a83703032c-e3b29.png\\\"\\n        srcset=\\\"/static/study-streak-e3cf398f9c16ca848a7552a83703032c-6572b.png 175w,\\n/static/study-streak-e3cf398f9c16ca848a7552a83703032c-e1ddf.png 350w,\\n/static/study-streak-e3cf398f9c16ca848a7552a83703032c-e3b29.png 700w,\\n/static/study-streak-e3cf398f9c16ca848a7552a83703032c-1eceb.png 1050w,\\n/static/study-streak-e3cf398f9c16ca848a7552a83703032c-5aa17.png 1140w\\\"\\n        sizes=\\\"(max-width: 700px) 100vw, 700px\\\"\\n      />\\n    </span>\\n  </span>\\n  <em>Here’s what the study streak looks like.</em></p>\\n<p>Now, this must be quite simple to program right? I’ve stored all the dates/times a student has tested themselves in a database, now all I need to do is get today’s date, and work backwards through the database, check if yesterday’s date is there and if so, check the previous day’s date and continue on until one of the dates is not available. However, something which I forgot about was that this would not work for students who live in a timezone other than GMT. Why? Because the server is based in the UK. The way I programmed the server is that every time a student tests themselves, the server will get the server’s date/time and logs it into the database.</p>\\n<h2>Coordinated Universal Time</h2>\\n<p>I found out that there is something called *Coordinated Universal Time (UTC) *time. Don’t ask me why it isn’t shortened down to UTC instead of CUT, <a href=\\\"https://www.timeanddate.com/time/utc-abbreviation.html\\\">you can read why here.</a> UTC is basically a global standard for timezones and it has the exact same time as GMT.</p>\\n<ul>\\n<li>\\n<p>The time in the UK as represented in UTC would simply be UTC+00:00, because as I said, UTC time is the same as GMT.</p>\\n</li>\\n<li>\\n<p>If we wanted the time in Australia, it would be represented as UTC+09:30 as it is 9 hours and 30 minutes ahead of the time in the UK.</p>\\n</li>\\n<li>\\n<p>The time in Hawaii would be UTC-10:00 as it is 10 hours behind of the time in the UK.</p>\\n</li>\\n</ul>\\n<h2>Dealing with UTC Server</h2>\\n<p>Okay so back to Revisify. By knowing this, if we stored the date/time in UTC+00:00, we could then convert that to the local time of the student is located. Luckily since I only have 1 server which happens to be based in the UK, the dates in the database are already in UTC+00:00. However, I still needed to change some Python code on the server:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-python\\\"><code class=\\\"language-python\\\"><span class=\\\"token keyword\\\">from</span> datetime <span class=\\\"token keyword\\\">import</span> datetime\\n\\n<span class=\\\"token comment\\\"># This gets the server time. If I moved the server to say Australia, it would not get UTC time.</span>\\ndate <span class=\\\"token operator\\\">=</span> datetime<span class=\\\"token punctuation\\\">.</span>now<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n\\n<span class=\\\"token comment\\\"># This gets UTC time regardless of where the server is located.</span>\\ndate <span class=\\\"token operator\\\">=</span> datetime<span class=\\\"token punctuation\\\">.</span>utcnow<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n</code></pre>\\n      </div>\\n<h2>Dealing with UTC Client Side</h2>\\n<p>Now that I ‘officially’ store UTC dates/times in the database, I need to convert these correctly to the student’s local time. This can be difficult to program yourself but luckily there’s a fantastic Javascript Library called <a href=\\\"http://momentjs.com/\\\">Moment.js</a> which takes out **a lot **of the strain of converting timezones. Here’s how easy it was for me to convert the UTC date/times that I got from the database into the local time of the student’s computer:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token comment\\\">// Server's UTC datetime</span>\\n<span class=\\\"token keyword\\\">var</span> utcDate <span class=\\\"token operator\\\">=</span> <span class=\\\"token string\\\">'2016-12-20 14:56:51'</span>\\n\\n<span class=\\\"token comment\\\">// Client's local datetime</span>\\n<span class=\\\"token keyword\\\">var</span> localDate <span class=\\\"token operator\\\">=</span> moment<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">utc</span><span class=\\\"token punctuation\\\">(</span>utcDate<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">local</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n</code></pre>\\n      </div>\\n<p>That simple line of code is all that is needed for the client to get the right date. This library has a lot more functions but I will leave that for another time.</p>\\n<p>Back to the study streak, I updated the code so that the server sends the dates and some Javascript on the client side calculates the study streak. The final result is <a href=\\\"https://gist.github.com/PavSidhu/8a3b04bc7f16ba6a2eb38f6803254fda\\\">available here</a> with some annotations as to how it works. You can also see it below:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token comment\\\">// Values for dates are received from the server</span>\\ndates <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span>i<span class=\\\"token operator\\\">=</span><span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">;</span> i <span class=\\\"token operator\\\">&lt;=</span> dates<span class=\\\"token punctuation\\\">.</span>length<span class=\\\"token operator\\\">-</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">;</span> i<span class=\\\"token operator\\\">++</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">var</span> date <span class=\\\"token operator\\\">=</span> date<span class=\\\"token punctuation\\\">[</span>i<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token keyword\\\">var</span> localDate <span class=\\\"token operator\\\">=</span> moment<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">utc</span><span class=\\\"token punctuation\\\">(</span>date<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">local</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">format</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'DDMMYY'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>i <span class=\\\"token operator\\\">===</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">var</span> today <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">moment</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">format</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'DDMMYY'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token keyword\\\">var</span> yesterday <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">moment</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">format</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'DDMMYY'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>localDate <span class=\\\"token operator\\\">===</span> today<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">||</span>\\n        localDate <span class=\\\"token operator\\\">===</span> yesterday<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        streak <span class=\\\"token operator\\\">+=</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token keyword\\\">else</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">var</span> previousDate <span class=\\\"token operator\\\">=</span> moment<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">utc</span><span class=\\\"token punctuation\\\">(</span>dates<span class=\\\"token punctuation\\\">[</span>i<span class=\\\"token operator\\\">-</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">local</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">format</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'DDMMYY'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token keyword\\\">var</span> previousDateYesterday <span class=\\\"token operator\\\">=</span> moment<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">utc</span><span class=\\\"token punctuation\\\">(</span>dates<span class=\\\"token punctuation\\\">[</span>i<span class=\\\"token operator\\\">-</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">local</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">subtract</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">'days'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">format</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'DDMMYY'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>localDate <span class=\\\"token operator\\\">!==</span> previousDate<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>localDate <span class=\\\"token operator\\\">===</span> previousDateYesterday<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        streak <span class=\\\"token operator\\\">+=</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token keyword\\\">else</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">break</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>There we have it. I have found that now I’ve used timezones once, it isn’t as difficult, but still somewhat confusing if I think about it in too much detail.</p>\\n<p>If you really want to melt your brain, this YouTube video by Tom Scott explains timezones in much more detail, enjoy (or not).</p>\\n<p><div>\\n          <div\\n            class=\\\"gatsby-resp-iframe-wrapper\\\"\\n            style=\\\"padding-bottom: 50%; position: relative; height: 0; overflow: hidden;\\\"\\n          >\\n            <div><iframe src=\\\"https://www.youtube.com/embed/-5wpm-gesOY\\\" style=\\\"\\n            position: absolute;\\n            top: 0;\\n            left: 0;\\n            width: 100%;\\n            height: 100%;\\n          \\\"></iframe></div>\\n          </div>\\n          </div></p>\",\"excerpt\":\"Something I recently found difficult to get my head around was how timezones work. It’s one of those things you tend to avoid as much as possible, however, I realised that there was quite a big flaw in my website, Revisify, that needed addressing. For those of you who don’t know, Revisify is a tool I built to help…\",\"frontmatter\":{\"title\":\"The Timezone Struggle\",\"date\":\"27th December 2016\",\"path\":\"/the-timezone-struggle\"}}},\"pathContext\":{}}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// path---the-timezone-struggle-b2ffdb245913314e347e.js","module.exports = {\"data\":{\"site\":{\"siteMetadata\":{\"title\":\"Pav Sidhu\",\"author\":\"Pav Sidhu\"}},\"markdownRemark\":{\"id\":\"/Users/bondor/Desktop/Lambda/Projects/blog/src/pages/2016-12-27-the-timezone-struggle/index.md absPath of file >>> MarkdownRemark\",\"html\":\"<p>Something I recently found difficult to get my head around was how timezones work. It’s one of those things you tend to avoid as much as possible, however, I realised that there was quite a big flaw in my website, Revisify, that needed addressing.</p>\\n<p>For those of you who don’t know, Revisify is a tool I built to help students study. Students can create questions, test themselves and progress. I have one feature available, study streaks, which count the number consecutive days a student has been studying.</p>\\n<p>\\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 700px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 57.45614035087719%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAABT0lEQVQoz4WS3UoCQRTHfYuSUtzV8WOdmd352q/MVhQxk5LIJNKKgiJauqmg296it+gNuusNuu8Zgu63Yx/i2pLwhzmHOb8558+ZFGJOwbJnpRORN1WeStAk/gpAc2VF7qbgmF6DkKn4erMsXEOtlYUHcdWuVaQP0omMVTInBkOfInN6w9He+PT4Itzo7vT2Rwdnl6PzsDcc56qs8DtRAjyZjcoctZdNb5X5iNmQIssucRfFyxJgKM0QJSz2UCuFnqERocNbVQaaNZ8AA6lRhSl7HZDothldeY9NY8kQKmizekvD/D8YUZnG6tAh0VHl4343uum89XWEmd3aqm32F8DfMweCvQ8L0V07uvaeuyhLlek3qBfMkQmeofkKlie+9TIQT9uWz3kGC15vyUZngedp/zSWaYOD2yxRkOpU/G37AyfswJSwT/gtKImZhT8BL+OH+bldzJgAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\\\"\\n        alt=\\\"Here’s what the study streak looks like.\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/study-streak-e3cf398f9c16ca848a7552a83703032c-e3b29.png\\\"\\n        srcset=\\\"/static/study-streak-e3cf398f9c16ca848a7552a83703032c-6572b.png 175w,\\n/static/study-streak-e3cf398f9c16ca848a7552a83703032c-e1ddf.png 350w,\\n/static/study-streak-e3cf398f9c16ca848a7552a83703032c-e3b29.png 700w,\\n/static/study-streak-e3cf398f9c16ca848a7552a83703032c-1eceb.png 1050w,\\n/static/study-streak-e3cf398f9c16ca848a7552a83703032c-5aa17.png 1140w\\\"\\n        sizes=\\\"(max-width: 700px) 100vw, 700px\\\"\\n      />\\n    </span>\\n  </span>\\n  <em>Here’s what the study streak looks like.</em></p>\\n<p>Now, this must be quite simple to program right? I’ve stored all the dates/times a student has tested themselves in a database, now all I need to do is get today’s date, and work backwards through the database, check if yesterday’s date is there and if so, check the previous day’s date and continue on until one of the dates is not available. However, something which I forgot about was that this would not work for students who live in a timezone other than GMT. Why? Because the server is based in the UK. The way I programmed the server is that every time a student tests themselves, the server will get the server’s date/time and logs it into the database.</p>\\n<h2>Coordinated Universal Time</h2>\\n<p>I found out that there is something called *Coordinated Universal Time (UTC) *time. Don’t ask me why it isn’t shortened down to UTC instead of CUT, <a href=\\\"https://www.timeanddate.com/time/utc-abbreviation.html\\\">you can read why here.</a> UTC is basically a global standard for timezones and it has the exact same time as GMT.</p>\\n<ul>\\n<li>\\n<p>The time in the UK as represented in UTC would simply be UTC+00:00, because as I said, UTC time is the same as GMT.</p>\\n</li>\\n<li>\\n<p>If we wanted the time in Australia, it would be represented as UTC+09:30 as it is 9 hours and 30 minutes ahead of the time in the UK.</p>\\n</li>\\n<li>\\n<p>The time in Hawaii would be UTC-10:00 as it is 10 hours behind of the time in the UK.</p>\\n</li>\\n</ul>\\n<h2>Dealing with UTC Server</h2>\\n<p>Okay so back to Revisify. By knowing this, if we stored the date/time in UTC+00:00, we could then convert that to the local time of the student is located. Luckily since I only have 1 server which happens to be based in the UK, the dates in the database are already in UTC+00:00. However, I still needed to change some Python code on the server:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-python\\\"><code class=\\\"language-python\\\"><span class=\\\"token keyword\\\">from</span> datetime <span class=\\\"token keyword\\\">import</span> datetime\\n\\n<span class=\\\"token comment\\\"># This gets the server time. If I moved the server to say Australia, it would not get UTC time.</span>\\ndate <span class=\\\"token operator\\\">=</span> datetime<span class=\\\"token punctuation\\\">.</span>now<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n\\n<span class=\\\"token comment\\\"># This gets UTC time regardless of where the server is located.</span>\\ndate <span class=\\\"token operator\\\">=</span> datetime<span class=\\\"token punctuation\\\">.</span>utcnow<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n</code></pre>\\n      </div>\\n<h2>Dealing with UTC Client Side</h2>\\n<p>Now that I ‘officially’ store UTC dates/times in the database, I need to convert these correctly to the student’s local time. This can be difficult to program yourself but luckily there’s a fantastic Javascript Library called <a href=\\\"http://momentjs.com/\\\">Moment.js</a> which takes out **a lot **of the strain of converting timezones. Here’s how easy it was for me to convert the UTC date/times that I got from the database into the local time of the student’s computer:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token comment\\\">// Server's UTC datetime</span>\\n<span class=\\\"token keyword\\\">var</span> utcDate <span class=\\\"token operator\\\">=</span> <span class=\\\"token string\\\">'2016-12-20 14:56:51'</span>\\n\\n<span class=\\\"token comment\\\">// Client's local datetime</span>\\n<span class=\\\"token keyword\\\">var</span> localDate <span class=\\\"token operator\\\">=</span> moment<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">utc</span><span class=\\\"token punctuation\\\">(</span>utcDate<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">local</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n</code></pre>\\n      </div>\\n<p>That simple line of code is all that is needed for the client to get the right date. This library has a lot more functions but I will leave that for another time.</p>\\n<p>Back to the study streak, I updated the code so that the server sends the dates and some Javascript on the client side calculates the study streak. The final result is <a href=\\\"https://gist.github.com/PavSidhu/8a3b04bc7f16ba6a2eb38f6803254fda\\\">available here</a> with some annotations as to how it works. You can also see it below:</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token comment\\\">// Values for dates are received from the server</span>\\ndates <span class=\\\"token operator\\\">=</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">for</span> <span class=\\\"token punctuation\\\">(</span>i<span class=\\\"token operator\\\">=</span><span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">;</span> i <span class=\\\"token operator\\\">&lt;=</span> dates<span class=\\\"token punctuation\\\">.</span>length<span class=\\\"token operator\\\">-</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">;</span> i<span class=\\\"token operator\\\">++</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">var</span> date <span class=\\\"token operator\\\">=</span> date<span class=\\\"token punctuation\\\">[</span>i<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">;</span>\\n  <span class=\\\"token keyword\\\">var</span> localDate <span class=\\\"token operator\\\">=</span> moment<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">utc</span><span class=\\\"token punctuation\\\">(</span>date<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">local</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">format</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'DDMMYY'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>i <span class=\\\"token operator\\\">===</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">var</span> today <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">moment</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">format</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'DDMMYY'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token keyword\\\">var</span> yesterday <span class=\\\"token operator\\\">=</span> <span class=\\\"token function\\\">moment</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">format</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'DDMMYY'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>localDate <span class=\\\"token operator\\\">===</span> today<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">||</span>\\n        localDate <span class=\\\"token operator\\\">===</span> yesterday<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        streak <span class=\\\"token operator\\\">+=</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token keyword\\\">else</span> <span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">var</span> previousDate <span class=\\\"token operator\\\">=</span> moment<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">utc</span><span class=\\\"token punctuation\\\">(</span>dates<span class=\\\"token punctuation\\\">[</span>i<span class=\\\"token operator\\\">-</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">local</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">format</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'DDMMYY'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token keyword\\\">var</span> previousDateYesterday <span class=\\\"token operator\\\">=</span> moment<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">utc</span><span class=\\\"token punctuation\\\">(</span>dates<span class=\\\"token punctuation\\\">[</span>i<span class=\\\"token operator\\\">-</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">local</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">subtract</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">'days'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">format</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'DDMMYY'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>localDate <span class=\\\"token operator\\\">!==</span> previousDate<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n      <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>localDate <span class=\\\"token operator\\\">===</span> previousDateYesterday<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        streak <span class=\\\"token operator\\\">+=</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n      <span class=\\\"token keyword\\\">else</span> <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">break</span><span class=\\\"token punctuation\\\">;</span>\\n      <span class=\\\"token punctuation\\\">}</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n  <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n</code></pre>\\n      </div>\\n<p>There we have it. I have found that now I’ve used timezones once, it isn’t as difficult, but still somewhat confusing if I think about it in too much detail.</p>\\n<p>If you really want to melt your brain, this YouTube video by Tom Scott explains timezones in much more detail, enjoy (or not).</p>\\n<p><div>\\n          <div\\n            class=\\\"gatsby-resp-iframe-wrapper\\\"\\n            style=\\\"padding-bottom: 50%; position: relative; height: 0; overflow: hidden;\\\"\\n          >\\n            <div><iframe src=\\\"https://www.youtube.com/embed/-5wpm-gesOY\\\" style=\\\"\\n            position: absolute;\\n            top: 0;\\n            left: 0;\\n            width: 100%;\\n            height: 100%;\\n          \\\"></iframe></div>\\n          </div>\\n          </div></p>\",\"excerpt\":\"Something I recently found difficult to get my head around was how timezones work. It’s one of those things you tend to avoid as much as possible, however, I realised that there was quite a big flaw in my website, Revisify, that needed addressing. For those of you who don’t know, Revisify is a tool I built to help…\",\"frontmatter\":{\"title\":\"The Timezone Struggle\",\"date\":\"27th December 2016\",\"path\":\"/the-timezone-struggle\"}}},\"pathContext\":{}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/json-loader!./.cache/json/the-timezone-struggle.json\n// module id = 343\n// module chunks = 245742162621177"],"sourceRoot":""}